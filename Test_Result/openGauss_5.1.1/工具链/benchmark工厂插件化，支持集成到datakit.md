版权所有 © 2023 openGauss社区 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[https://creativecommons.org/licenses/by-sa/4.0/](https://gitee.com/link?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-sa%2F4.0%2F) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[https://creativecommons.org/licenses/by-sa/4.0/legalcode。](https://gitee.com/link?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-sa%2F4.0%2Flegalcode%E3%80%82)

修订记录

| 日期       | 修订 版本 | 修改描述 | 作者        |
| ---------- | --------- | -------- | ----------- |
| 2023-11-15 | V1.0      | 初稿     | houshaolong |

关键词：

benchmark、DataKit

摘要：

目前的benchmark工厂由于其依赖众多的工具，并不能方便的移植其主程序到任意环境中。因此想要利用benchmark工厂的基础功能扩展到其他类型的数据库并不方便，基于以上原因，且openGauss的DataKit平台恰好提供了各类数据库等资源的运维管理功能，借助Datakit的能力可以方便的将目前的benchmark工厂的基础功能推广到更多测试任务的需求。

缩略语清单：

| 缩略语 | 英文全名  | 中文解释 |
| ------ | --------- | -------- |
| N/A    | benchmark | N/A      |

# 1 特性概述



# 2 特性测试信息

##### 功能测试

| 版本名称                | 测试起始时间 | 测试结束时间 |
| ----------------------- | ------------ | ------------ |
| benchmark-factory 5.1.1 | 2023-10-21   | 2023-11-8    |
| benchmark-factory 5.1.1 | 2023-11-9    | 2023-11-15   |
| benchmark-factory 5.1.1 | 2023-11-15   | 2023-12-14   |

硬件环境信息：

##### 功能测试

| 环境信息 | 配置信息                                                     | 备注 |
| -------- | ------------------------------------------------------------ | ---- |
| 虚拟机   | Intel(R) Xeon(R) Gold 6266C CPU @ 3.00GHz 4核 内存：32GB 硬盘：300GB OS：CentOS Linux release 7.6.1810 (Core) |      |

# 3 测试结论概述

## 3.1 测试整体结论

benchmark工厂插件化，支持集成到DataKit，共执行用例10个，主要覆盖了功能测试、及资料测试，功能测试主要覆盖创建测试任务，查看任务报告，查看编排信息，删除benchmark任务结果，测试各输入框、弹框、可选项等可用性，黑夜模式下各功能以及显示情况，以及易用性等。资料测试覆盖校验资料的描述是否完整。累计发现缺陷单5个，5个缺陷已解决，回归通过，整体质量良好。

## 3.2 约束说明

* DataKit环境已搭建

## 3.3 遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

| 问题单号 | 问题描述 | 问题级别 | 问题影响和规避措施 | 当前状态 |
| -------- | -------- | -------- | ------------------ | -------- |
| N/A      | N/A      | N/A      | N/A                | N/A      |

### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   | 5        | 0    | 1    | 4    | 0      |
| 百分比 | 100%     | 0%   | 20%  | 80%  | 0%     |

### 3.3.3 问题单汇总

| 序号 | issue号                                                      | 级别 | 问题简述                                                     | 状态   | 备注 |
| ---- | ------------------------------------------------------------ | ---- | ------------------------------------------------------------ | ------ | ---- |
| 1    | [I8F85W](https://e.gitee.com/opengaussorg/issues/list?issue=I8F85W) | 主要 | 【benchmark】创建benchmark任务时安装和执行任务使用初始用户任务报错，且无日志 | 已验收 |      |
| 2    | [I8IG3L](https://e.gitee.com/opengaussorg/issues/list?issue=I8IG3L) | 次要 | 【benchmark】任务执行时，benchmark配置启动文件不正确         | 已验收 |      |
| 3    | [I8IFOO](https://e.gitee.com/opengaussorg/issues/list?issue=I8IFOO) | 次要 | 【benchmark】创建benchmark任务后，部分设置UI界面未保存下来，无法再次查看 | 已验收 |      |
| 4    | [I8F8A6](https://e.gitee.com/opengaussorg/issues/list?issue=I8F8A6) | 次要 | 【benchmark】任务执行结束，主程序日志无法查看                | 已验收 |      |
| 5    | [I8F87X](https://e.gitee.com/opengaussorg/issues/list?issue=I8F87X) | 次要 | 【benchmark】任务中心创建的任务，删除时没有确认删除的提示，直接删除掉了 | 已验收 |      |

# 4 测试执行

## 4.1 功能测试实现步骤

1、配置benchmark

2、选择benchmark安装服务器

3、选择待测数据库，开始执行

### 4.1.1 功能测试-使用root用户创建benchmark测试任务

| 测试步骤                                                     | 测试结果                                |
| ------------------------------------------------------------ | --------------------------------------- |
| 1. 配置benchmark<br />2.安装benchmark服务器，安装用户选择root用户 | 执行1条用例，执行结果符合预期，测试通过 |



### 4.1.2 功能测试-使用初始用户创建benchmark测试任务

| 测试步骤                                                     | 测试结果                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1. 配置benchmark<br />2.安装benchmark服务器，安装用户选择初始用户 | 执行1条用例，执行结果符合预期，测试通过，发现2个bug，2个问题已解决回归通过 |

### 4.1.3 功能测试-benchmark任务结束后，查看任务报告

| 测试步骤                                                     | 测试结果                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1. 配置benchmark<br />2.安装benchmark服务器<br />3.选择待测数据库<br />4.执行任务并查看任务报告 | 执行1条用例，执行结果符合预期，测试通过，发现1个bug，1个问题已解决回归通过 |

### 4.1.4 功能测试-查看benchmark编排信息，不允许修改

| 测试步骤                                                     | 测试结果                                |
| ------------------------------------------------------------ | --------------------------------------- |
| 1. 点击任务中心，选择已执行任务点击查看编排文件<br />2.一次点击下一步<br />3.尝试修改参数值或者用户 | 执行1条用例，执行结果符合预期，测试通过 |

### 4.1.5 功能测试-UI页面功能测试

| 测试步骤                                                     | 测试结果                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1. 分别测试删除benchmark任务结果，测试各输入框、弹框、可选项等可用性，黑夜模式下各功能以及显示情况 | 执行6条用例，执行结果符合预期，测试通过，发现2个bug，2个问题已解决回归通过 |

## 4.3 资料测试

| 测试步骤                   | 测试结果                   |
| -------------------------- | -------------------------- |
| 1. 文档描述<br>2. 文档示例 | 文档描述准确，示例正确无误 |

## 4.4 测试数据统计

根据用例进行测试验证，结果如下：

| 版本名称                | 测试用例数 | 用例执行结果           | 发现问题单数 |
| ----------------------- | ---------- | ---------------------- | ------------ |
| benchmark-factory 5.1.1 | 10         | Passed:7<br/>Failed:3  | 3            |
| benchmark-factory 5.1.1 | 10         | Passed:8<br/>Failed: 2 | 2            |
| benchmark-factory 5.1.1 | 10         | Passed:10<br/>Failed:0 | 0            |

*数据项说明：*

- 累计发现缺陷单5个，5个缺陷已解决且回归通过
- 失败用例已在后续问题修复后，回归issue执行通过
- 缺陷密度：5(缺陷个数)20.107/kloc(代码行数)=0.249(个/kloc)

## 4.5 后续测试建议

1、测试除TPCC外的兼容性测试和ISV防伪测试

# 5 附件

benchmark工厂插件化PR<br>https://codehub-y.huawei.com/openGauss-server/bmf_plugin/merge_requests/1<br>benchmark插件资料PR<br>https://codehub-y.huawei.com/openGauss-server/bmf_plugin/merge_requests/8