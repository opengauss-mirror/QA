![输入图片说明](../../../image.png)

版权所有 © 2023  openGauss社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期      | 修订   版本 | 修改描述             | 作者      |
| :-------- | ----------- | -------------------- | --------- |
| 2023-3-23 | 1.0         | 特性测试报告初稿完成 | baixiaoli |
| 2023-3-24 | 2.0         | 修改特性测试报告 | baixiaoli |

 关键词： 

openEuler22.03LTS系统  数据库内核 工具  编译  运行

摘要：

本文档为openGauss支持数据库内核、OM、CM、JDBC/ODBC/python驱动、libpq以及迁移工具在openEuler 22.03LTS系统可编译、可运行的测试报告。

缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
| 无     |          |          |

# 1     特性概述

本特性主要根据openEuler 22.03LTS操作系统版本、gcc版本、python版本和三方库与openEuler 20.03LTS系统的差异进行适配修改，在编译时判断系统版本，通过变量宏定义来控制使用不同的头文件；openEuler 22.03LTS系统中MINSIGSTKSZ宏定义不再是常量，需手动将其定义为常量；openEuler 22.03LTS系统默认python版本为python3.9，且OM强依赖python版本，因此，需要定制python3.9编译的三方库版本供OM编译使用，命名为install_tools_python39，并修改OM编译脚本，根据系统python版本去获取对应的三方库组件路径。

# 2     特性测试信息

| 版本名称                       | 测试起始时间 | 测试结束时间 |
| ------------------------------ | ------------ | ------------ |
| openGauss 3.1.1 build 2e4f56c4 | 2023-1-12    | 2023-1-17    |
| openGauss 3.1.1 build b658f54c | 2023-1-18    | 2023-1-30    |
| openGauss 3.1.1 build 95a55bfd | 2023-1-31    | 2023-2-16    |

| 架构 | 硬件配置信息                                                 | 备注 |
| ---- | ------------------------------------------------------------ | ---- |
| arm  | cpu型号：Kunpeng-920<br/>内存：32GB<br/>硬盘：ssd<br/>OS：openEuler release 22.03 LTS |      |
| x86  | cpu型号：Intel(R) Xeon(R) Gold 6278C CPU @ 2.60GHz<br/>内存：32GB<br/>硬盘：ssd<br/>OS：openEuler release 22.03 LTS |      |

# 3     测试结论概述

## 3.1   测试整体结论

openGauss支持openEuler 22.03LTS系统共执行35个用例，主要覆盖功能测试、性能测试和长稳测试，主要包含在x86架构和arm架构的openEuler  22.03LTS系统编译数据库内核、OM、CM、JDBC/ODBC/python驱动、libpq以及迁移工具，以不同方式的安装数据库并执行基本SQL用例，以及TPCC性能测试、长稳测试和资料测试。共发现0个问题，整体质量良好。

| 测试活动 | 活动评价                                                     |
| :------- | :----------------------------------------------------------- |
| 功能测试 | 测试编译安装包、OM、CM、JDBC/ODBC/python驱动、libpq以及迁移工具，测试达到预期结果 |
| 功能测试 | 分别测试编译安装、以OM方式安装、带CM安装、极简安装数据库并执行sql语句和测试om/cm工具的使用，并进行轻量版安装测试，测试达到预期结果 |
| 功能测试 | 用JDBC/ODBC/python驱动连接数据库执行sql语句，测试达到预期结果 |
| 性能测试 | 进行TPCC性能测试，测试达到预期结果                             |
| 长稳测试 | 进行3*24小时长稳测试，测试达到预期结果                                       |
| 资料测试 | 资料描述准确，操作步骤清晰无误，测试达到预期结果             |

## 3.2   约束说明

1. openEuler 22.03LTS系统已经安装各个模块所需依赖。
2. 只支持x86和arm两种架构。
3. OM编译使用定制三方库。

## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

| 问题单号                                                     | 问题描述                                 | 问题级别 | 问题影响及规避措施 | 当前状态 |
| ------------------------------------------------------------ | ---------------------------------------- | -------- | :----------------- | -------- |
| 无 |      |      |                  |      |

### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   | 0    | 0  | 0   | 0  | 0      |
| 百分比 | 0% | 0% | 0% | 0% | 0%     |

###  3.3.3 问题单汇总

| issue号                                                      | 问题级别 | 问题简述                                 | 问题状态 |
| ------------------------------------------------------------ | -------- | ---------------------------------------- | -------- |
| 无 |      |    |    |

# 4     测试执行

## 4.1 测试执行步骤

###  4.1.1功能测试

#### 4.1.1.1编译测试

| 测试步骤：                                                   | 测试结果                        |
| ------------------------------------------------------------ | ------------------------------- |
| 1.分别在x86架构PAGE_SIZE=4k、arm架构PAGE_SIZE=4k和arm架构PAGE_SIZE=64k的openEuler 22.03LTS系统编译安装包、OM、CM、JDBC/ODBC/python驱动、libpq以及迁移工具 | 共执行3条用例，执行结果符合预期 |

#### 4.1.1.2数据库安装运行测试

| 测试步骤：                                                   | 测试结果                         |
| ------------------------------------------------------------ | -------------------------------- |
| 1.在x86架构PAGE_SIZE=4k、arm架构PAGE_SIZE=4k和arm架构PAGE_SIZE=64k的openEuler 22.03LTS系统分别测试编译安装、以OM方式安装、带CM安装、极简安装数据库并执行sql语句和测试om/cm工具的使用，并进行轻量版安装测试 | 共执行21条用例，执行结果符合预期 |

#### 4.1.1.3 JDBC/ODBC/python驱动测试

| 测试步骤：                                                   | 测试结果                               |
| ------------------------------------------------------------ | -------------------------------------- |
| 1.在x86架构PAGE_SIZE=4k、arm架构PAGE_SIZE=4k和arm架构PAGE_SIZE=64k的openEuler 22.03LTS系统使用JDBC/ODBC/python驱动连接数据库执行sql语句 | 共执行9条用例，执行结果符合预期 |

### 4.1.2性能测试

| 测试步骤：                                                   | 测试结果                    |
| ------------------------------------------------------------ | --------------------------- |
| 1.极简安装数据库<br/>2.进行1000仓696并发1小时TPCC测试<br/>3.观察测试数据及数据库状态 | 执行2条用例，执行符合预期 |

### 4.1.3长稳测试

| 测试步骤：                                                   | 测试结果       |
| ------------------------------------------------------------ | -------------- |
| 1.极简安装数据库<br/>2.进行1000仓696并发3*24小时TPCC测试<br/>3.数据库状态 | 数据库状态正常 |

### 4.1.4资料测试

| 测试步骤：                                               | 测试结果         |
| -------------------------------------------------------- | ---------------- |
| 1.检查资料描述是否准确、约束覆盖是否全面以及示例是否正确 | 检查结果符合预期 |

## 4.2  测试执行统计数据

| 版本名称                       | 测试用例数 | 用例执行结果             | 发现问题单数 |
| ------------------------------ | ---------- | ------------------------ | ------------ |
| openGauss 3.1.1 build 2e4f56c4 | 3      | Passed : 3  Failed : 0 | 0           |
| openGauss 3.1.1 build b658f54c | 30 | Passed : 30  Failed : 0 | 0 |
| openGauss 3.1.1 build 95a55bfd | 2       | Passed : 2   Failed : 0 | 0            |

*数据项说明：*

无

## 4.3   后续测试建议

1.部署openEuler 22.03LTS自动化环境，跑可靠性全量用例。

# 5     附件

无