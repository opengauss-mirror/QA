![avatar](../../../images/openGauss.png)

版权所有 © 2024  openGauss社区
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA
4.0”)
的约束。为了方便用户理解，您可以通过访问[*https://creativecommons.org/licenses/by-sa/4.0/*](https://creativecommons.org/licenses/by-sa/4.0/)
了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA
4.0的完整协议内容您可以访问如下网址获取：[*https://creativecommons.org/licenses/by-sa/4.0/legalcode*](https://creativecommons.org/licenses/by-sa/4.0/legalcode)
。

修订记录

| 日期        | 修订版本 | 修改章节    | 修改描述                  | 作者   |
|-----------| ------- |---------|-----------------------| ------ |
| 2024.9.16 | 1.0     | 初稿撰写    |                       | Feiling Peng |
| 2024.09.19 | 1.1 | 3、4、5、6 | 更新问题统计、问题列表、个人贡献、测试结论 | Feiling Peng |

目 录

1 概述

2 测试版本说明

3 版本概要测试结论

4 版本详细测试结论

> 4.1 特性测试结论

> 4.2 专项测试结论

5 问题单统计

6 附件

7 致谢

**Keywords 关键词**：openGauss 6.0.0

**Abstract 摘要**：主要是描述了openGauss 6.0.0 版本的整体测试情况，给出本阶段的测试范围、结果、分析及质量评价，同时对测试活动进行回顾总结。

> 缩略语清单：

| 缩略语 | 英文全名                    | 中文解释       |
| ------ | --------------------------- | -------------- |
| SQL    | Structured Query Language   | 结构化查询语言 |
| LTS    | Long Time support           | 长时间维护     |
| DML    | Data Manipulation Language  | 数据操纵语言   |
| DDL    | Data Definition Language    | 数据定义语言   |
| DCL    | Data Control Language       | 数据控制语言   |
| CM     | Cluster Management          | 集群管理工具   |
| DMS    | Distributed Memory Service  | 分布式内存服务 |
| DSS    | Distributed Storage Service | 分布式存储服务 |

***

# 概述

openGauss是一款全面友好开放，携手伙伴共同打造的企业级开源关系型数据库。openGauss提供面向多核架构的极致性能、全链路的业务、数据安全、基于AI的调优和高效运维的能力。openGauss具有高性能、高可靠、高安全和易运维等特性，深度融合华为在数据库领域多年的研发经验，结合企业级场景需求，持续构建竞争力特性。

openGauss 6.0.0 版本新增内核场景化、工具链和兼容性等特性（具体特性名可以查看"测试版本说明"
章节中的需求列表），并对若干关键缺陷进行了修改。本文主要描述了openGauss 6.0.0
版本整体测试情况，重点从特性质量、专项测试和问题单统计等维度展开叙述。综合来看，openGauss 6.0.0 版本整体质量良好。

# 测试版本说明

本章节描述测试版本的基本信息，包括测试对象是什么，以及在什么环境下开展的测试，具体包括被测版本和测试硬件环境。

描述被测对象的版本信息和测试的时间及测试轮次。

| 版本名称                         | 测试起始时间     | 测试结束时间 |
| ------------------------------- |------------| ------------ |
| openGauss 6.0.0  Test round 1 | 2024-7-4  | 2024-7-10 |
| openGauss 6.0.0  Test round 2 | 2024-8-1  | 2024-8-7  |
| openGauss 6.0.0  Test round 3 | 2024-8-8  | 2024-8-14 |
| openGauss 6.0.0  Test round 4 | 2024-8-29 | 2024-9-4  |
| openGauss 6.0.0  Test round 5 | 2024-9-12 | 2024-9-18 |

描述本次测试的测试环境（包括环境软硬件版本信息，环境组网配置信息， 测试辅助工具等）。

| 硬件型号                              | 硬件配置信息                                                 | 备注 |
| ------------------------------------- | ------------------------------------------------------------ | ---- |
| Huawei TaiShan 200 (Model 2280)  | CPU：Kunpeng-920 8核<br />内存：16GB<br />硬盘：509G<br />OS：openEuler release 20.03 (LTS-SP4)<br />文件系统：ext4<br />网卡：Huawei Technologies Co., Ltd. iBMA Virtual Network Adapter  |      |

虚拟化平台

| 虚拟化平台 | 版本说明                                                           |
| ---------- |----------------------------------------------------------------|
| KVM虚拟化         | KVM+openEuler release 20.03 (LTS-SP4)                      |

OS版本说明如下：

| 操作系统  | OS版本           | 版本说明                        |
| --------- | ---------------- |-----------------------------|
| OpenEuler | 20.03 (LTS)      | openEuler 20.03 (LTS) aarch |

openGauss 6.0.0 版本是openGauss社区继续联合多方力量推出的版本，本次发布的需求列表、分工如下：

| 序号  | 需求                                                         | 开发主体      | 测试主体 | 验证策略                                                     |
|-----| ------------------------------------------------------------ | ------------- | -------- | ------------------------------------------------------------ |
| 1   |DataKit 业务开发- 消息窗口功能优化|Tools|QA| 测试SQL执行成功（插入/非插入）、执行错误的情况。执行成功时显示：开始执行时间、执行结束时间、执行时长、操作影响的记录行数<br>执行失败时显示：执行状态、错误代码、报错提示<br>每条SQL执行的消息之间间隔一行                                                                                                          |
| 2   |DataKit 业务开发- 对象窗口功能优化|Tools|QA| 无数据库连接时不可新建终端按钮及连接选择下拉框隐藏。有数据库连接时显示按钮及下拉框，下拉框列表显示已经建立的连接。<br>测试所有可新建终端的入口：新建终端按钮点击新建、左侧数据库名节点右键创建终端、终端Tab右键点击”新建终端“                                                                                                   |
| 3   |DataKit 业务开发- 执行窗口功能优化|Tools|QA| 测试插件各类窗口悬停显示，悬停标签分层级显示。<br>（1）数据库对象的显示格式为：<br>”数据库对象类型“（例如普通表/外表/视图）：xxx<br>模式：xxx<br>数据库：xxx<br>连接：xxx<br>（2）终端窗口显示格式为：<br>终端：xxx<br>数据库：xxx<br>连接：xxx<br>（3）其他类型的窗口显示格式为：<br>"功能页面名称"（例如表空间/定时任务）：xxx<br>连接：xxx<br> |
| 4   |DataKit 业务开发- 实例连接状态功能优化|Tools|QA| 测试连接成功及连接失败的情况。连接成功：提示成功及耗时<br>连接失败：提示对应的失败内容<br>(1)用户密码错误<br>(2)端口号错误<br>(3)ip错误<br>(4)数据库错误<br>                                                                                                                     |
| 5   |DataKit 业务开发- 新建连接功能优化|Tools|QA| 测试左侧数据库导航列表中一级节点的状态图标显示。存在至少一个数据库连接时显示绿色连接图标。断开所有库的连接显示红色未连接图标。连接超时状态不更新。                                                                                                                                             |
| 6   |【国创】实例监控插件性能与稳定性优化       | Tools|QA|测试实例监控接口性能、资源占用。测试长期监控时是否有掉点。测试安装多个prometheus时，prometheus启动/停止后，采集时间段内的数据情况。测试代理或prometheus异常情况下及恢复后的数据采集 |
| 7   |【国创】智能诊断插件SQL诊断功能支持Schema | Tools|QA|测试Schema为public时的SQL诊断任务执行，测试 Schema为其他模式时的SQL诊断任务执行                                                      |
| 8   |【国创】智能诊断插件SQL诊断功能支持非ROOT用户 | Tools|QA|测试使用ROOT用户安装/启动/停止/卸载，并执行SQL诊断任务。测试 使用非ROOT用户安装/启动/停止/卸载，并执行SQL诊断任务                                       |
| 9   |【国创】支持慢SQL统计功能           |Tools|QA| 测试慢SQL统计列表、趋势图的查询/排序/统计数据结果正确性，测试慢SQL明细列表查询/排序/统计数据结果正确性                                                  |
| 10  |【国创】告警监控插件提供插件告警接口       |Tools|QA| 测试插件告警规则的新建/编辑/查看/删除，测试插件告警模板的新建/编辑/查看/删除，测试插件告警配置，测试插件告警记录的查询/导出，测试插件告警通知                                |
| 11  |【国创】支持告警屏蔽               | Tools|QA|测试告警屏蔽规则的 新建/编辑/查看/删除，测试告警屏蔽生效/失效。测试告警屏蔽生效时、若告警状态恢复，告警记录可正常结束。                                            |

# 版本概要测试结论

阶段一：

进行需求验收及问题单验收，主要涉及工具链的新特性验收，同时对继承测试开展全量接口测试，并对每个特性的测试报告进行了评审。

阶段二：

对关键性能数据进行了摸底测试，而且再次对继承特性进行了自动化看护。

openGauss 6.0.0 版本按照测试策略完成了功能验证和专项测试（性能、兼容性），
共发现问题15个，有效问题15个，无效问题0，遗留6个问题（1个功能问题、5个性能问题）。修复问题回归测试结果正常，版本整体质量良好。

# 版本详细测试结论

## 特性测试结论

### 继承特性评价

对产品所有继承特性进行评价，用表格形式评价，包括特性列表（与特性清单保持一致），验证质量评估

| Domain           | Feature            | 质量评估                   | 备注                                                        |
| ---------------- | ------------------ | -------------------------- | ----------------------------------------------------------- |
|   DataKit        | 智能运维           | <font color=yellow><font color=yellow>▲</font></font>| 测试智能运维模块，关注各子特性功能正常及界面显示正常         |
|                  | 业务开发           | <font color=green>▮</font> | 测试业务开发模块，关注各子特性功能正常及界面显示正常         |

<font color=red><font color=red>●</font></font>： 表示特性不稳定，风险高

<font color=yellow><font color=yellow>▲</font></font>： 表示特性基本可用，遗留少量问题

<font color=green>▮</font>： 表示特性质量良好

### 新需求评价

建议以表格的形式汇总新特性测试执行情况及遗留问题单情况的评估，给出特性质量评估结论。

| 特性名称                                                     | 测试情况说明                                                    | 约束                                        | 质量电灯                    |
| ------------------------------------------------------------ |-----------------------------------------------------------|-------------------------------------------| --------------------------- |
|DataKit 业务开发- 实例连接状态功能优化| 测试连接状态显示，执行4个用例，未发现问题。                                    | 当用户长时间未操作，连接超时后，状态不会自动更新，需用户操作发起请求后才会更新状态 |<font color=green>▮</font>|
|DataKit 业务开发- 新建连接功能优化| 测试新建编辑连接时，进行测试连接操作。执行3个用例，未发现问题。                          | 无                                         |<font color=green>▮</font>|
|DataKit 业务开发- 对象窗口功能优化| 测试查看标签名称显示。执行1个用例，未发现问题。                                  | 无                                         |<font color=green>▮</font>|
|DataKit 业务开发- 消息窗口功能优化| 测试SQL执行信息、历史执行SQL的错误信息。执行5个用例，未发现问题。                      | 无                                         |<font color=green>▮</font>|
|DataKit 业务开发- 执行窗口功能优化| 测试已打开的SQL终端窗口右键菜单增加新建SQL终端，测试无连接时无创建SQL终端按钮。执行3个用例，未发现问题。 | 无                                         |<font color=green>▮</font>|
|【国创】实例监控插件性能与稳定性优化| 测试采集数据稳定性。 执行5个用例，发现2个问题，遗留1个问题。                          | 无                                         |<font color=yellow>▲</font>|
|【国创】智能诊断插件SQL诊断功能支持Schema | 测试选择不同Schema进行诊断。执行5个用例，发现1个问题，问题已修复。                     | 无                                         |<font color=green>▮</font>|
|【国创】智能诊断插件SQL诊断功能支持非ROOT用户 | 测试使用不同用户安装诊断Agent并执行SQL诊断任务。执行6个用例，未发现问题。                 | 无                                         |<font color=green>▮</font>|
|【国创】支持慢SQL统计功能 | 测试慢SQL统计列表及趋势图。执行14个用例，发现1个问题，问题已修复。                      | 无                                         |<font color=green>▮</font>|
|【国创】告警监控插件提供插件告警接口  | 测试插件告警与实例告警。执行7个用例，未发现问题。                                 | 无                                         |<font color=green>▮</font>|
|【国创】支持告警屏蔽   | 测试按实例屏蔽实例告警。执行15个用例，发现1个问题，问题已修复。                         | 只支持屏蔽实例的告警，不支持屏蔽插件告警。                     |<font color=green>▮</font>|

<font color=red>●</font>： 表示特性不稳定，风险高

<font color=yellow>▲</font>： 表示特性基本可用，遗留少量问题

<font color=green>▮</font>： 表示特性质量良好

## 专项测试结论

### 安全测试

### 可靠性测试

### 性能测试

对主要功能的性能指标进行摸底和测试，覆盖了http接口性能测试、分析CPU和内存占用。本项性能测试设置并发用户数为100，每1秒启动20个用户，执行接口测试脚本120秒，停止后等待时间为180秒，在执行脚本期间及前后时间进行资源占用采集，共采集360秒。

| **指标大项**      | **指标小项**                                               | **指标值**                                                                                                 | **说明**                                                                                                                                                                                                                                                                                            | 测试结论                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ----------------- | ---------------------------------------------------------- |---------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|工具链|业务开发插件执行用户管理相关接口性能测试脚本、分析CPU、内存占用| 最大响应时间：非数据库连接接口<=3s，数据库连接接口<=6s<br>最小响应时间：非数据库连接接口<=500ms，数据库连接接口<=1.5s<br>平均响应时间：单接口<=1.5s，数据库连接接口<=3s |  | 1、平均接口响应时长及最小接口响应时长符合标准，最大响应时长超过3s，但99%的样本小于3s，属于可接受范围。<br> 2、脚本执行期间，平台CPU和内存均增长，符合预期。被测数据库CPU增长较大，未超过预期。                                                                                                                                                                                                                                                                                                                                                     |
|                   | 业务开发插件执行表管理相关接口性能测试脚本、分析CPU、内存占用    |最大响应时间：非数据库连接接口<=3s，数据库连接接口<=6s<br>最小响应时间：非数据库连接接口<=500ms，数据库连接接口<=1.5s<br>平均响应时间：单接口<=1.5s，数据库连接接口<=3s                                                                                                          |  | 1、 大部分接口响应时长符合标准。创建表接口超过预期，平均响应时长达到2.377s ，20%左右的样本超过3s。<br>脚本执行期间，平台CPU和内存均增长，符合预期。被测数据库CPU增长较大，未超过预期。                                                                                                                                                                                                                                                                                                                                                       |
|                   | 业务开发插件执行视图相关接口性能测试脚本、分析CPU、内存占用   | 最大响应时间：非数据库连接接口<=3s，数据库连接接口<=6s<br>最小响应时间：非数据库连接接口<=500ms，数据库连接接口<=1.5s<br>平均响应时间：单接口<=1.5s，数据库连接接口<=3s                                                                                                         |  | 1、接口响应时长符合标准，<br>脚本执行期间，平台CPU和内存均增长，符合预期。被测数据库CPU增长较大，未超过预期。                                                                                                                                                                                                                                                                                                                                                                                                  |
|                   | 智能运维插件执行告警屏蔽相关接口性能测试脚本、分析CPU、内存占用。基础数据量为25条告警屏蔽规则。 | 最大响应时间：非数据库连接接口<=3s，数据库连接接口<=6s<br>最小响应时间：非数据库连接接口<=500ms，数据库连接接口<=1.5s<br>平均响应时间：单接口<=1.5s，数据库连接接口<=3s                                                                                                         |  | 1、大部分接口响应时长符合标准，其中告警屏蔽列表查询接口（/api/v1/alertShielding）的最大响应时长超过3s，达到了6.8s，需要优化。<br> 2、脚本执行期间（第2s到第5分钟2秒），平台CPU和内存占用均增长，CPU在428%~650.5%（除以核数后为53.5%~81.31%）之间波动，内存在3335.75M~3415.18M之间波动，CPU占用和内存占用均小于70%，符合预期。<br>平台数据库CPU在54%~282.4%（除以核数后为6.75%~35.3%）之间波动，内存在1126.4M~1331.2M之间波动，CPU及内存占用均未超过预期。                                                                                                                                                             |
|                   |智能运维插件执行实例监控相关接口性能测试脚本、分析CPU、内存占用。 | 最大响应时间：非数据库连接接口<=3s，数据库连接接口<=6s<br>最小响应时间：非数据库连接接口<=500ms，数据库连接接口<=1.5s<br>平均响应时间：单接口<=1.5s，数据库连接接口<=3s                                                                                                         |  | 1、大部分接口响应时长符合标准，其中asp的接口、实例监控首页TOP进程接口的平均响应时长超过预期值，达3s以上。需要优化。<br> 2、脚本执行期间（第2s到第5分钟2秒），平台、平台数据库、被测数据库的CPU和内存占用均增长，最大值未超过预期值。脚本执行结束后会降低。<br>被测数据库的CPU在390%~644.2%（除以核数后为48.75%~80.525%）之间波动，内存在1945.6M~3174.4M之间波动。<br>一级prometheus的最大CPU占用为250.5%(除以核数后为31.31%)，内存最大占用为143.85M；<br>二级prometheus的最大CPU占用为50%(除以核数后为6.25%)，内存最大占用为867.13M；<br>二级prometheus的最大CPU占用为27.5%(除以核数后为3.44%)，内存最大占用为58.24M；<br>实例监控代理的最大CPU占用为93.1%(除以核数后为11.64%)，内存最大占用为504.95M。<br> |

### 兼容性测试

#### 升级兼容

#### 硬件兼容

| Domain       | 测试活动                                                 | 测试结论 |
| ------------ |------------------------------------------------------| -------- |
| 硬件兼容   | 支持在鲲鹏服务器上部署、Huawei 2288H V5上部署 DataKit及业务开发插件和智能运维插件 | 测试通过 |

#### 软件兼容

| Domain       | 测试活动                                                                                                                                              | 测试结论    |
| ------------ |---------------------------------------------------------------------------------------------------------------------------------------------------| ----------- |
| 操作系统兼容 | 支持在arm+openEuler 20.03 LTS上部署 DataKit平台及业务开发插件和智能运维插件                                                                                             |测试通过|
| 数据库兼容  | 智能运维插件支持监控openGauss 3.0.0、openGauss 5.0.1、openGauss 6.0.0。 业务开发插件支持连接openGauss 3.0.0、openGauss 5.0.1、openGauss 6.0.0，其中覆盖率功能仅在openGauss 6.0.0版本可用 |测试通过|

### 资料测试

# 问题单统计

openGauss 6.0.0
版本共发现问题15个，有效问题15个，无效问题0。修复问题回归测试结果正常，版本整体质量良好。遗留6个问题详细分布见下表:

| 版本名称                          | 测试起始时间    | 测试结束时间    | 有效问题数 | 无效问题数 |
|-------------------------------|-----------|-----------|-------|-------|
| openGauss 6.0.0  Test round 1 | 2024-7-4  | 2024-7-10 | 2     | 0     |
| openGauss 6.0.0  Test round 2 | 2024-8-1  | 2024-8-7  | 1     | 0     |
| openGauss 6.0.0  Test round 3 | 2024-8-8  | 2024-8-14 | 2     | 0     |
| openGauss 6.0.0  Test round 4 | 2024-8-29 | 2024-9-4  | 1     | 0     |
| openGauss 6.0.0  Test round 5 | 2024-9-12 | 2024-9-18 | 9     | 0     |

# 附件

## 附件1：遗留问题列表

| 序号  | issue号 | 问题简述                              | 分类   | 问题级别                                  | 问题分析与影响                               | 规避措施                               |
|-----| ---- |-----------------------------------|------|---------------------------------------|---------------------------------------|------------------------------------|
| 1   |  IAS1N3   | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_prometheus停止后立马启动异常                 | 工具链  | 一般                                    | 出现概率10%，近期未复现。                        | 停止以后等1秒后再点击启动                      |
| 2   |  IAS1U9   | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_升级_二级prometheus和exporter启动异常      | 工具链 | 一般                                    | 二级prom版本比较旧                           | 重新安装二级prom或者手动将配置写入prom，然后重新启动prom |
| 3   | IAS22A    | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_elastic出现异常、占用高                   | 工具链 | 一般                                    | 日志数据量较大时CPU占用较高达到38%                  | 安装elastic的服务器需有足够资源                |
| 4   |  IAS25V   | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_[SQLite] 实例监控/告警监控初始化耗时较长         | 工具链 | 一般                                    | 启动插件时，需要加载脚本，脚本过大导致初始化慢，不影响功能         | 等待插件初始化完成                          |
| 5   |  IAS2WG   | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_告警性能问题                        | 工具链 | 一般                                    | 接口并发性能问题，不影响功能                        | 并发高的时候需等待响应。                              |
|6| IAS2G9|【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_【掉点相关】实例数据采集刷新问题| 工具链 | 一般 | 由于网络等原因，采集数据超过代码中设定的时间，导致数据未采集到，出现掉点。 | 暂无法通过配置文件设置采集超时时间，需要修改原代码根据实际情况增加超时时间 |

## 附件2：问题单列表

| 序号 | issue号 | 问题简述 | 优先级                                        |
|----|------|--------------------------------------------|--------------------------------------------|
| 1 |IARQ21| 【工具功能】【测试版本：6.0.0】DataKit-智能运维_实例监控_指标数据问题 | 次要 |
| 2 |IAR6A2| 【集群监控】_主备切换后集群详情中的图表报错                     | 次要 |
| 3 |IAR657| 【业务开发】编辑表列_勾选是否唯一并保存_提示表已经存在               | 次要 |
| 4 |IAONY7| 告警监控插件测试缺陷                                 | 主要 |
| 5 |IAI06J| 【国创】业务开发插件编辑表数据前端优化                        | 次要 |
| 6 |IAIO5M| 【国创】业务开发插件编辑表数据黑夜模式下样式显示问题                 | 次要 |
| 7 |IAHX49| 【国创】业务开发插件无法导出表数据                          | 主要 |
| 8 |IABORE| 日志检索插件缺陷                                   | 次要 |
| 9 |IAB8MN| 智能诊断插件缺陷                                   | 次要 |
| 10 | IAS1N3 | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_prometheus停止后立马启动异常 | 一般                                         |
| 11 | IAS1U9 | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_升级_二级prometheus和exporter启动异常 | 一般                                         |
| 12 | IAS22A | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_elastic出现异常、占用高 | 一般                                         |
| 13 | IAS25V | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_[SQLite] 实例监控/告警监控初始化耗时较长 | 一般                                         |
| 14 | IAS2WG | 【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_告警性能问题 | 一般                                         |
|15| IAS2G9|【测试类型：工具功能】【测试版本：6.0.0】DataKit-智能运维_【掉点相关】实例数据采集刷新问题 | 一般                                         |

## 个人贡献

本版本创建15个issue。

# 致谢

感谢参与撰写本文、或在过程中给出宝贵指导意见的各位社区开发者（排名不分先后）

+ [@sungang](https://gitee.com/sungang14)
