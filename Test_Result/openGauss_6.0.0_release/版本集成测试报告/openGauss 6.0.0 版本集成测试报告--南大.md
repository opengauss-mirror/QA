![avatar](../../images/openGauss.png)

版权所有 © 2024  openGauss社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[*https://creativecommons.org/licenses/by-sa/4.0/*](https://creativecommons.org/licenses/by-sa/4.0/) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[*https://creativecommons.org/licenses/by-sa/4.0/legalcode*](https://creativecommons.org/licenses/by-sa/4.0/legalcode)。

修订记录

| 日期     | 修订版本 | 修改章节 | 修改描述 | 作者     |
| -------- | -------- | -------- | -------- | -------- |
| 2024.9.5 | 1.0      | 初稿撰写 |          | xuexinyi |

目 录

1 概述

2 测试版本说明

3 版本概要测试结论

4 版本详细测试结论

> 4.1 特性测试结论

> 4.2 专项测试结论

5 问题单统计

6 附件

7 致谢

**Keywords 关键词**：openGauss 6.0.0 

**Abstract 摘要**：主要是描述了openGauss 6.0.0 版本的整体测试情况，给出本阶段的测试范围、结果、分析及质量评价，同时对测试活动进行回顾总结。

> 缩略语清单： 

| 缩略语 | 英文全名                    | 中文解释       |
| ------ | --------------------------- | -------------- |
| SQL    | Structured Query Language   | 结构化查询语言 |
| LTS    | Long Time support           | 长时间维护     |
| DML    | Data Manipulation Language  | 数据操纵语言   |
| DDL    | Data Definition Language    | 数据定义语言   |
| DCL    | Data Control Language       | 数据控制语言   |
| CM     | Cluster Management          | 集群管理工具   |
| DMS    | Distributed Memory Service  | 分布式内存服务 |
| DSS    | Distributed Storage Service | 分布式存储服务 |

 

***


# 概述

openGauss是一款全面友好开放，携手伙伴共同打造的企业级开源关系型数据库。openGauss提供面向多核架构的极致性能、全链路的业务、数据安全、基于AI的调优和高效运维的能力。openGauss具有高性能、高可靠、高安全和易运维等特性，深度融合华为在数据库领域多年的研发经验，结合企业级场景需求，持续构建竞争力特性。

openGauss 6.0.0 版本新增内核场景化和兼容性等特性（具体特性名可以查看"测试版本说明"章节中的需求列表），并对若干关键缺陷进行了修改。本文主要描述了openGauss 6.0.0 版本整体测试情况，重点从特性质量、专项测试和问题单统计等维度展开叙述。综合来看，openGauss 6.0.0 版本整体质量良好。

# 测试版本说明

本章节描述测试版本的基本信息，包括测试对象是什么，以及在什么环境下开展的测试，具体包括被测版本和测试硬件环境。

描述被测对象的版本信息和测试的时间及测试轮次。

| 版本名称                       | 测试起始时间 | 测试结束时间 |
| ------------------------------ | ------------ | ------------ |
| openGauss 6.0.0 build 982a7bec | 2024-06-11   | 2024-06-14   |
| openGauss 6.0.0 build 229b15f3 | 2024-06-03   | 2024-07-03   |
| openGauss 6.0.0 build 2f96703a | 2024-07-31   | 2024-08-05   |
| openGauss 6.0.0 build a04eaf40 | 2024-08-15   | 2024-08-15   |
| openGauss 6.0.0 build 2f96703a | 2024-08-08   | 2024-08-12   |

描述本次测试的测试环境（包括环境软硬件版本信息，环境组网配置信息， 测试辅助工具等）。

| 硬件型号                             | 硬件配置信息                                                 | 备注     |
| ------------------------------------ | ------------------------------------------------------------ | -------- |
| CentOS Linux release 7.9.2009 (Core) | CPU：Intel(R) Xeon(R) CPU E5-2640 v2 @ 2.00GHz<br />内存：4GB<br />硬盘：500GB<br />OS：CentOS Linux 7 (Core) | 单机部署 |



OS版本说明如下：

| 操作系统 | OS版本           | 版本说明                                                     |
| -------- | ---------------- | ------------------------------------------------------------ |
| CentOS   | 7.9.2009 (Core） | CentOS Linux release 7.9.2009 (Core)，x86-64版本ISO<br />SHA256:6d44331cc4f6c506c7bbe9feb8468fad6c51a88ca1393ca6b8b486ea04bec3c1 |

openGauss 6.0.0 版本是openGauss社区继续联合多方力量推出的版本，本次发布的需求列表、分工如下：

| 序号 | 需求                                                         | 开发主体 | 测试主体 | 验证策略                                                     |
| ---- | ------------------------------------------------------------ | -------- | -------- | ------------------------------------------------------------ |
| 1    | 【openGauss 6.0.0】【兼容性】select支持rotate/not rotate子句 | Plugin   | QA       | 1、验证只在兼容A库下可执行及其A库下的基本功能<br/>2、验证各种不同的数据类型下进行单列/多列行列转换，表类型包含普通表、临时表、分区表、ustore表等；数据类型包含空值、特殊字符、中文等<br/>3、验证聚合函数、子查询、并行查询中使用行列转换<br/>4、验证opengauss与A库性能相比无明显劣化 |
| 2    | 【openGauss 6.0.0】【兼容性】支持通过alter trigger方式启用禁用单个触发器 | Plugin   | QA       | 1、验证只在兼容A库下可执行及其A库下的基本功能<br/>2、验证新语法对原有的触发器功能和系统表不受影响<br/>3、并发场景下，验证多条语句插入时，触发器的触发情况；以及一条语句触发多个触发器情况下的可靠性验证<br />4、跨会话执行，验证触发器是否生效 |
| 3    | 【openGauss 6.0.0 】【兼容性】支持启用禁用tables约束测试报告 | Plugin   | QA       | 1、验证基本功能正常<br/>2、验证日志信息以及资源统计、sql日志显示正常；<br/>3、长稳验证，验证长期在数据库对表约束增删改查操作，数据库无异常；<br />4、验证增加表约束后，对操作表的性能无明显影响； |
| 4    | 【openGauss 6.0.0】【兼容性】openGauss 6.0.0版本支持GMS_STATS包 | Plugin   | QA       | 1、验证各种场景下函数入参正常，验证场景中包含同名表、临时表、同义词表、特殊字符表、表数量多、列存表、分区表、gis表、unlogged表、ustore表、压缩表、物化视图等；<br />2、并行场景验证，函数插入表同时进行统计无异常报错<br />3、错误入参场景验证，包括存在的schema以及函数名相同的schema、schema无访问权限、schema下部分表无访问权限的场景<br />4、动态语句/begin等场景下正常使用 |
| 5    | 【openGauss 6.0.0】【兼容性】插件GMS_PROFILER的功能          | Plugin   | QA       | 1、验证函数入参、函数功能、存储过程中收集的信息等正常<br/>2、验证异常值、错误入参等异常场景下报错准确<br />3、验证动态语句/begin等场景下正常使用<br />4、验证函数组合使用功能以及在其他高级包中使用正常 |

# 版本概要测试结论

openGauss 6.0.0 版本整体测试按照release-manager团队的计划，版本测试规划采取5+2的测试方式，即5轮系统测试+2轮回归测试的策略，实际完成了5轮系统测试+2轮回归测试：

第一轮至第五轮进行迭代1的需求验收及问题单验收，主要涉及兼容性内核场景化的新特性验收，同时对继承测试开展第一阶段第一轮的全量手工测试，覆盖可靠性、安全、性能、长稳等测试。第六至第七轮集中验收第一阶段修复完成的问题单，并对每个特性的测试报告进行了评审。

openGauss 6.0.0 版本按照测试策略完成了全量功能验证和专项测试（性能、可靠性、兼容性、安全和资料等），所有测试任务均按计划完成。本版本计划交付需求5个，实际交付5个，交付率100%，所有发布需求均验证通过。

openGauss 6.0.0 版本共发现问题6个，有效问题6个。修复问题回归测试结果正常，其中有一个遗留转需求问题，版本整体质量良好，无遗留问题。

# 版本详细测试结论

openGauss 6.0.0 版本详细测试内容包括：

1、通过手工测试，从数据库兼容性、性能、可靠性等几个维度进行openGauss特性测试，基本功能无异常且不对以往能力引入问题；

2、专项测试包括性能专项、安全专项、兼容性测试、可靠性测试和资料测试。

## 特性测试结论

### 继承特性评价

对产品所有继承特性进行评价，用表格形式评价，包括特性列表（与特性清单保持一致），验证质量评估

| Domain           | Feature      | 质量评估                   | 备注                                                         |
| ---------------- | ------------ | -------------------------- | ------------------------------------------------------------ |
| 数据库服务       | SQL语法      | <font color=green>▮</font> | 继承已有测试能力，支持DDL/DML/DCL/DQL语句，不同特性组合下用户、权限的验证(含资源池化、兼容性)(表/视图/索引等基础对象，fdw、postgis、物化视图) (含资源池化、兼容性) |
|                  | 主备管理     | <font color=green>▮</font> | 继承已有测试能力，极致RTO、switchover、failover等            |
|                  | 内核工具链   | <font color=green>▮</font> | 继承已有测试能力，gs_ctl/gstrace/perctrl/pg_config/pagehack/pg_recvlogic/pg_controldata/pg_xlogdump/pg_resetxlog/gs_restore等 |
| 数据库管理与运维 | 安装卸载     | <font color=green>▮</font> | 继承已有测试能力，测试数据库安装、卸载全流程                 |
|                  | 升级         | <font color=green>▮</font> | 测试带业务操作下多升级路径覆盖，升级成功后，特性功能运行正常 |
|                  | 运维视图     | <font color=green>▮</font> | 测试系统表与系统视图、系统schema(如dbe_perf、information_schema、WDR、pldebugger、db4ai等) |
| 数据库兼容性     | 环境兼容     | <font color=green>▮</font> | 测试硬件兼容、操作系统兼容、依赖软件版本                     |
|                  | 驱动兼容     | <font color=green>▮</font> | 测试jdbc/odbc/libpq/psycopg2等 mysql兼容(协议兼容、类型兼容)继承已有测试能力，支持JDBC、ODBC、PDBC、GDBC驱动 |
|                  | oracle兼容性 | <font color=green>▮</font> | 测试SQL语法（单双引号、反引号、关键字、类型、函数、操作符等）、通信协议 |
|                  | mysql兼容性  | /                          | /                                                            |
|                  | pg兼容性     | /                          | /                                                            |

<font color=red><font color=red>●</font></font>： 表示特性不稳定，风险高

<font color=yellow><font color=yellow>▲</font></font>： 表示特性基本可用，遗留少量问题

<font color=green>▮</font>： 表示特性质量良好

### 新需求评价

建议以表格的形式汇总新特性测试执行情况及遗留问题单情况的评估，给出特性质量评估结论。

| 特性名称                                                     | 测试情况说明                                                 | 约束                                                         | 质量电灯                   | 遗留问题 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------------------------- | -------- |
| 【openGauss 6.0.0 】【兼容性】select支持rotate/not rotate子句 | select支持rotate/not rotate子句特性，共计执行26个用例，主要覆盖了功能测试、性能测试和资料测试，发现1个问题，遗留风险0个，整体质量良好；本次测试主要覆盖各种sql场景下，使用rotate/not rotate子句的方式进行行转列、列转行功能验证、异常场景下的合理报错、复杂场景的正常使用，发现issue1个，已验收通过，整体质量良好； | 仅支持数据库模式为A模式                                      | <font color=green>▮</font> | 无       |
| 【openGauss 6.0.0 】【兼容性】支持通过alter trigger方式启用禁用单个触发器 | alter trigger方式启用禁用单个触发器特性，共计执行31个用例，主要覆盖了功能测试、语法测试、耦合测试、可靠性测试和资料测试，本次测试主要覆通过alter trigger的方式的启停功能验证、异常场景下的合理报错、以及不影响原有功能交互。测试未发现问题，无遗留风险，整体质量良好； | 仅支持数据库模式为A模式                                      | <font color=green>▮</font> | 无       |
| 【openGauss 6.0.0 】【兼容性】支持启用禁用tables约束测试     | 共计执行46个用例，主要覆盖了功能测试、性能测试、安全测试、资料测试，稳定性测试；发现issue2个，整体质量良好；测试中发现2个问题，都已验收通过，整体质量良好。 | enable/disable novalidate对primary key，unique不生效         | <font color=green>▮</font> | 无       |
| 【openGauss 6.0.0 】【兼容性】openGauss 6.0.0版本支持GMS_STATS包 | 支持GMS_STATS包特性，共计执行23个用例，主要覆盖了功能测试、兼容性测试和资料测试，本次测试主要覆盖gms_stats包功能覆盖的gs_analyze_schema_tables函数以及gms_stats.gather_schema_stats存储过程的功能验证、异常场景下的合理报错、复杂场景的正常使用。发现1个问题，已经验收通过，整体质量良好。 | （1）删除扩展时需要设定参数support_extended_features = on<br />（2）不统计空表<br />（3）不支持收集临时表信息<br />（4）仅支持A模式库 | <font color=green>▮</font> | 无       |
| 【openGauss 6.0.0 】【兼容性】插件GMS_PROFILER的功能         | 共计执行32个用例，主要覆盖了功能测试、资料测试，发现issue1个，已验收通过，整体质量良好； | （1）仅支持Create extension命令方式加载插件。<br />（2） 不支持存储过程中存在异常处理的场景，会导致收集信息不准确。<br />（3） 如果测试过程调用了flush_data接口，不支持其后调用ROOLBACK操作，会报错。如需使用ROOLBACK, 建议统一通过stop_profiler接口完成收集信息写表。 | <font color=green>▮</font> | 无       |

<font color=red>●</font>： 表示特性不稳定，风险高

<font color=yellow>▲</font>： 表示特性基本可用，遗留少量问题

<font color=green>▮</font>： 表示特性质量良好

## 专项测试结论

### 安全测试

openGauss 6.0.0 版本安全测试覆盖：

1、验证日志信息，查看资源统计，sql日志是否正确

2、从数据库新特性中的越权风险管理、数据库审计、数据库内存问题、数据库安全框架设计问题和数据库操作系统等方面进行安全测试。

openGauss 6.0.0 版本所有适用的安全扫描和安全测试均已执行，整体质量良好，风险可控。

### 可靠性测试

无

### 性能测试

对行列转换特性关键性能指标进行摸底和测试，主要采用最简单的表结构插入不同大小和行数的表，性能多轮测试稳定。

| **指标大项** | **指标小项**                          | **指标值**  | **说明**                      | 测试结论                                      |
| ------------ | ------------------------------------- | ----------- | ----------------------------- | --------------------------------------------- |
| 维度         | 单表1w行数据进行行转列 阶段耗时统计   | 72.314ms    | 指标为A库中相同条件下执行耗时 | 单表1w行数据进行行转列 阶段耗时为86.622ms     |
|              | 单表1w行数据进行列转行 阶段耗时统计   | 68.945ms    | 指标为A库中相同条件下执行耗时 | 单表1w行数据进行列转行 阶段耗时为63.275ms     |
|              | 单表10w行数据进行行转列 阶段耗时统计  | 284.652ms   | 指标为A库中相同条件下执行耗时 | 单表10w行数据进行行转列 阶段耗时为298.302ms   |
|              | 单表10w行数据进行列转行 阶段耗时统计  | 292.430ms   | 指标为A库中相同条件下执行耗时 | 单表10w行数据进行列转行 阶段耗时为322.173ms   |
|              | 单表100w行数据进行行转列 阶段耗时统计 | 10145.612ms | 指标为A库中相同条件下执行耗时 | 单表100w行数据进行行转列 阶段耗时为9853.012ms |
|              | 单表100w行数据进行列转行 阶段耗时统计 | 9988.235ms  | 指标为A库中相同条件下执行耗时 | 单表100w行数据进行列转行 阶段耗时为9821.347ms |

### 兼容性测试

#### 升级兼容

针对openGauss 6.0.0 版本，规划的升级路径如下表所示。测试整体情况：

1. openGauss 5.0.1/openGauss 6.0.0升级到openGauss 6.0.0 成功，升级失败或者升级未提交，可以成功回滚；
2. 故障场景下，环境恢复后升级可以重入并升级成功
3. 升级成功后，特性功能运行正常

| 升级路径                                                     | 测试结论 |
| ------------------------------------------------------------ | -------- |
| openGauss 5.0.1/openGauss 6.0.0灰度升级到openGauss 6.0.0     | 测试通过 |
| openGauss 5.0.1/openGauss 6.0.0就地升级到openGauss 6.0.0     | 测试通过 |
| openGauss 5.0.1/openGauss 6.0.0带cm灰度升级到openGauss 6.0.0带cm | 测试通过 |

#### 硬件兼容

| Domain     | 测试活动                                                     | 测试结论 |
| ---------- | ------------------------------------------------------------ | -------- |
| 服务器兼容 | 在X86（Intel(R) Xeon(R) Gold）服务器上安装部署openGauss 6.0.0 数据库 | 测试通过 |

#### 软件兼容

| Domain       | 测试活动                                              | 测试结论 |
| ------------ | ----------------------------------------------------- | -------- |
| 操作系统兼容 | 在X86+Centos7.9环境下，安装部署openGauss 6.0.0 数据库 | 测试通过 |

### 资料测试

| 序号 | **手册名称** | **测试结论** |
| ---- | ------------ | ------------ |
| 1    | 《插件参考》 | PASS         |
| 2    | 《SQL参考》  | PASS         |

# 问题单统计

openGauss 6.0.0 版本共发现问题6个，有效问题6个，无效问题0个。修复问题回归测试结果正常，版本整体质量良好。有一个非特性测试中发现的转需求遗留问题。 

# 附件

## 附件1：遗留问题列表

| 序号 | issue号 | 问题简述                                                     | 分类    | 问题级别 | 问题分析与影响                                             |
| ---- | ------- | ------------------------------------------------------------ | ------- | -------- | ---------------------------------------------------------- |
| 1    | IAMESB  | 【测试类型：SQL功能】【测试版本：6.0.0】 setof管道函数创建指定数据类型varchar(2)长度和实际插入的长度不符，预期创建函数成功，调用返回值失败；实际调用长度，未处理长度https://gitee.com/opengauss/openGauss-server/issues/IAMESB | sql功能 | 次要     | 存储过程返回值精度问题，当前精度未控制，类似的问题已转需求 |

# 致谢

感谢参与撰写本文、或在过程中给出宝贵指导意见的各位社区开发者（排名不分先后）

+ [@justbk](https://gitee.com/justbk)
+ [@wan005](https://gitee.com/wan005)
+ [@peilinqian](https://gitee.com/peilinqian)
+ [@liu-tong-8848](https://gitee.com/liu-tong-8848)
+ [@li-xin12345](https://gitee.com/@li-xin12345)