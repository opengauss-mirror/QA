![avatar](../../../images/openGauss.png)

版权所有 © 2022  openGauss社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期       | 修订版本 | 修改描述         | 作者  |
| ---------- | -------- | ---------------- | ----- |
| 2022/12/28 | 1.0      | 特性报告初稿完成 | lixin |
| 2022/12/30 | 1.1      | 特性报告初稿完成 | lixin |

关键词： 双引号、兼容性

摘要：本文档主要介绍在M*兼容性下，测试通过开关控制，是否支持使用双引号表示字符串 ，包含功能测试及资料测试，并给出最终测试结论。

缩略语清单：

| 缩略语    | 英文全名  | 中文解释          |
| --------- | --------- | ----------------- |
|NA | | |

# 1     特性概述

在M*兼容性下，在插件的guc参数dolphin.sql_mode中添加一个选项ansi_quotes（默认开启），用这个参数来可控制双引号是否被作为引用的符号。这个选项打开时，认为双引号可以用于引用，当这个ansi_quotes关闭时，则认为双引号引用的内容为字符串常量。

# 2     特性测试信息

| 版本名称                       | 测试起始时间 | 测试结束时间 |
| ------------------------------ | ------------ | ------------ |
| openGauss 3.1.0 build eda65fcc | 2022-10-31   | 2022-11-16   |

| 环境信息 | 配置信息                                                 | 备注 |
| -------- | ------------------------------------------------------------ | ---- |
| 虚拟机   | CPU：Intel(R) Xeon(R) Gold 6278C CPU @ 2.60GHz<br/>内存：32GB<br/>硬盘：1040GB<br/>OS：CentOS Linux release 7.6.1810 (core) |      |

# 3     测试结论概述

## 3.1   测试整体结论

共设计14个用例，主要覆盖了ansi_quotes开启/ 关闭时，双引号功能测试、资料测试。共计发现2个问题，均已修复验收，本轮测试无遗留问题，整体质量良好。

| 测试活动 | 活动评价                                                     |
| -------- | ------------------------------------------------------------ |
| 功能测试 | ansi_quotes开启时，双引号功能测试                            |
| 功能测试 | ansi_quotes关闭时，双引号功能测试                            |
| 资料测试 | 开发者指南>M*兼容性说明>dolphin Extension > dolphin语法介绍 > GUC参数说明中更新ansi_quotes相关资料，描述清晰，实例正确 |

## 3.2   约束说明

- 仅在dolphin插件支持使用
- 需要通过dolphin.sql_mode参数选择是否关闭双引号引用
- 在ansi_quotes关闭之后，双引号不能再作为引用进行使用

## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

| 问题单号 | 问题描述 | 问题级别 | 问题影响和规避措施 | 当前状态 |
| -------- | -------- | -------- | ------------------ | -------- |
| NA       |          |          |                    |          |

### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   | 2      | 0    | 0    | 0   | 2     |
| 百分比 |   100%       | 0%   | 0%   | 0%  | 100%   |

### 3.3.3 问题单汇总

|序号| issue号                                                      | 级别 | 问题简述                                     | 状态   |
| ---- | ------------------------------------------------------------ | ---- | -------------------------------------------- | ------ |
| 1    | [I61E79](https://e.gitee.com/opengaussorg/issues/list?issue=I61E79) | 不重要 | 【测试类型：资料】【测试版本：3.1.1】 dolphin下参数sql_mode新增控制双引号作用的参数值ansi_quotes，无相关资料 | 已验收 |
| 2 | [I61FB1](https://e.gitee.com/opengaussorg/issues/list?issue=I61FB1) | 不重要 | 【测试类型：资料】【测试版本：3.1.1】  dolphin下guc参数sql_mode文档描述问题汇总 | 已验收 |

# 4     测试执行

## 4.1 测试执行步骤

###  4.1.1 ansi_quotes开启时，双引号功能测试

| 测试步骤                                                     | 测试结果                         |
| ------------------------------------------------------------ | -------------------------------- |
| 1. ansi_quotes开启，测试字符串类型的插入、将字符串用作表达式（函数、操作符、类型转换等）的入参、测试元命令使用等，观察是否能正常使用，以及结果是否正确<br />2. 查看执行结果与预期一致<br />3. 清理环境 | 执行7条用例，执行通过，未发现bug |

### 4.1.2ansi_quotes关闭时，双引号功能测试

| 测试步骤                                                     | 测试结果                         |
| ------------------------------------------------------------ | -------------------------------- |
| 1. ansi_quotes关闭，测试字符串类型的插入、将字符串用作表达式（函数、操作符、类型转换等）的入参、测试元命令使用等，观察是否能正常使用，以及结果是否正确<br />2. 查看执行结果与预期一致<br />3. 清理环境 | 执行7条用例，执行通过，未发现bug |

## 4.2  测试执行统计数据

| 版本名称                       | 测试用例数 | 用例执行结果             | 发现问题单数 |
| ------------------------------ | ---------- | ------------------------ | ------------ |
| openGauss 3.1.0 build eda65fcc | 14        | Passed：14<br>Failed：0 | 2           |


*数据项说明：*

* 累计发现缺陷单2个，均已解决且回归通过
* 以上缺陷单均为资料单，不计入代码缺陷密度计算，代码缺陷密度为 0(缺陷个数)/0.239k(代码行数)=0(个/kloc)

## 4.3   后续测试建议

无

# **5     附件**

无

****

